<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8" />
  <title>Виртуальная лаборатория: Гальванический элемент</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body { font-family: Arial, sans-serif; max-width: 900px; margin: 30px auto; padding: 20px; }
    .input-group { margin: 15px 0; }
    label { display: inline-block; width: 250px; }
    input, select { padding: 5px; }
    #result { margin: 20px 0; padding: 15px; background: #f0f8ff; border-left: 4px solid #007bff; }
    canvas { margin-top: 20px; }
  </style>
</head>
<body>
  <h1>Расчёт ЭДС гальванического элемента</h1>
  <p>Элемент: <span id="cell-scheme">Zn | Zn²⁺ || Cu²⁺ | Cu</span></p>

  <div class="input-group">
    <label>Анод (металл):</label>
    <select id="anode">
      <option value="Zn">Zn</option>
      <option value="Fe">Fe</option>
    </select>
    <input type="number" id="anode-conc" value="0.1" step="0.01" min="0.001"> М
  </div>

  <div class="input-group">
    <label>Катод (металл):</label>
    <select id="cathode">
      <option value="Cu">Cu</option>
      <option value="Ag">Ag</option>
    </select>
    <input type="number" id="cathode-conc" value="0.01" step="0.01" min="0.001"> М
  </div>

  <button onclick="calculate()">Рассчитать ЭДС</button>

  <div id="result"></div>
  <canvas id="emfChart" width="400" height="300"></canvas>

  <script>
    // Стандартные потенциалы (В) при 25°C
    const E0 = {
      'Zn': -0.76,
      'Fe': -0.44,
      'Cu': +0.34,
      'Ag': +0.80
    };

    let chart = null;

    function calculate() {
      const anode = document.getElementById('anode').value;
      const cathode = document.getElementById('cathode').value;
      const c_anode = parseFloat(document.getElementById('anode-conc').value);
      const c_cathode = parseFloat(document.getElementById('cathode-conc').value);

      if (!E0[anode] || !E0[cathode]) {
        alert('Электрод не поддерживается');
        return;
      }

      const E0_anode = E0[anode];
      const E0_cathode = E0[cathode];

      // Уравнение Нернста (для двухэлектронных процессов: M²⁺ + 2e⁻ → M)
      const R = 8.314;  // Дж/(моль·К)
      const T = 298;    // К
      const F = 96485;  // Кл/моль
      const n = 2;      // число электронов (упрощённо)

      const E_anode = E0_anode + (R*T/(n*F)) * Math.log(c_anode);
      const E_cathode = E0_cathode + (R*T/(n*F)) * Math.log(c_cathode);
      const EMF = E_cathode - E_anode;

      document.getElementById('cell-scheme').textContent =
        `${anode} | ${anode}²⁺ (${c_anode} M) || ${cathode}²⁺ (${c_cathode} M) | ${cathode}`;

      document.getElementById('result').innerHTML = `
        <p><b>E°(анод) = ${E0_anode.toFixed(2)} В</b></p>
        <p><b>E°(катод) = ${E0_cathode.toFixed(2)} В</b></p>
        <p><b>ЭДС = ${EMF.toFixed(3)} В</b></p>
      `;

      plotChart(anode, cathode, c_anode, c_cathode);
    }

    function plotChart(anode, cathode, c_anode, c_cathode) {
      const concentrations = [];
      const emfValues = [];
      for (let c = 0.001; c <= 1.0; c *= 1.5) {
        concentrations.push(c);
        const E_anode = E0[anode] + (0.059/2) * Math.log10(c_anode); // упрощённая форма при 25°C
        const E_cathode = E0[cathode] + (0.059/2) * Math.log10(c);
        emfValues.push((E_cathode - E_anode).toFixed(3));
      }

      const ctx = document.getElementById('emfChart').getContext('2d');
      if (chart) chart.destroy();
      chart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: concentrations.map(c => c.toFixed(3)),
          datasets: [{
            label: `ЭДС при [${cathode}²⁺] (М)`,
            data: emfValues,
            borderColor: '#007bff',
            tension: 0.3
          }]
        },
        options: {
          responsive: true,
          plugins: { title: { display: true, text: 'Зависимость ЭДС от концентрации катода' } },
          scales: { y: { title: { display: true, text: 'ЭДС (В)' } } }
        }
      });
    }

    // Первый расчёт при загрузке
    calculate();
  </script>
</body>
</html>